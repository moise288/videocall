(this["webpackJsonpvideo-chat"]=this["webpackJsonpvideo-chat"]||[]).push([[0],{21:function(e,t,n){},24:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var r,a,c,o=n(2),i=n.n(o),s=n(15),l=n.n(s),d=(n(21),n(9)),u=n.n(d),f=n(13),p=n(10),b=n(11);n(27);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function j(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function v(e,t){var n=e.title,i=e.titleId,s=j(e,["title","titleId"]);return o.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-phone-missed",ref:t,"aria-labelledby":i},s),n?o.createElement("title",{id:i},n):null,r||(r=o.createElement("line",{x1:23,y1:1,x2:17,y2:7})),a||(a=o.createElement("line",{x1:17,y1:1,x2:23,y2:7})),c||(c=o.createElement("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})))}var m,O,x,g=o.forwardRef(v);n.p;function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function C(e,t){var n=e.title,r=e.titleId,a=w(e,["title","titleId"]);return o.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-more-vertical",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,m||(m=o.createElement("circle",{cx:12,cy:12,r:1})),O||(O=o.createElement("circle",{cx:12,cy:5,r:1})),x||(x=o.createElement("circle",{cx:12,cy:19,r:1})))}var k,S,I=o.forwardRef(C);n.p;function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function P(e,t){var n=e.title,r=e.titleId,a=N(e,["title","titleId"]);return o.createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-copy",ref:t,"aria-labelledby":r},a),n?o.createElement("title",{id:r},n):null,k||(k=o.createElement("rect",{x:9,y:9,width:13,height:13,rx:2,ry:2})),S||(S=o.createElement("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})))}var R=o.forwardRef(P),T=(n.p,n(24),n(3));b.a.apps.length||b.a.initializeApp({apiKey:"AIzaSyC6RXNJRwg6Jze8oI4nyR54u263SPw1Drk",authDomain:"videocall-b838d.firebaseapp.com",projectId:"videocall-b838d",storageBucket:"videocall-b838d.appspot.com",messagingSenderId:"309339173693",appId:"1:309339173693:web:6c3e90101d619c02608b54"});var D=b.a.firestore(),L=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10});function J(e){var t=e.joinCode,n=e.setJoinCode,r=e.setPage;return Object(T.jsxs)("div",{className:"home",children:[Object(T.jsx)("div",{className:"create box",children:Object(T.jsx)("button",{className:"btn-appeler",onClick:function(){return r("create")},children:"Appeler"})}),Object(T.jsxs)("div",{className:"answer box",children:[Object(T.jsx)("input",{value:t,onChange:function(e){return n(e.target.value)},placeholder:"Joindre avec le code"}),Object(T.jsx)("button",{className:"btn-repondre",onClick:function(){return r("join")},children:"R\xe9pondre"})]})]})}function A(e){var t=e.mode,n=e.callId,r=e.setPage,a=Object(o.useState)(!1),c=Object(p.a)(a,2),i=c[0],s=c[1],l=Object(o.useState)(n),d=Object(p.a)(l,2),b=d[0],h=d[1],j=Object(o.useRef)(),v=Object(o.useRef)(),m=function(){var e=Object(f.a)(u.a.mark((function e(){var r,a,c,o,i,l,d,f,p,b,m,x,g,y;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 2:if(r=e.sent,a=new MediaStream,r.getTracks().forEach((function(e){L.addTrack(e,r)})),L.ontrack=function(e){e.streams[0].getTracks().forEach((function(e){a.addTrack(e)}))},j.current.srcObject=r,v.current.srcObject=a,s(!0),"create"!==t){e.next=27;break}return c=D.collection("calls").doc(),o=c.collection("offerCandidates"),i=c.collection("answerCandidates"),h(c.id),L.onicecandidate=function(e){e.candidate&&o.add(e.candidate.toJSON())},e.next=17,L.createOffer();case 17:return l=e.sent,e.next=20,L.setLocalDescription(l);case 20:return d={sdp:l.sdp,type:l.type},e.next=23,c.set({offer:d});case 23:c.onSnapshot((function(e){var t=e.data();if(!L.currentRemoteDescription&&(null===t||void 0===t?void 0:t.answer)){var n=new RTCSessionDescription(t.answer);L.setRemoteDescription(n)}})),i.onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type){var t=new RTCIceCandidate(e.doc.data());L.addIceCandidate(t)}}))})),e.next=47;break;case 27:if("join"!==t){e.next=47;break}return f=D.collection("calls").doc(n),p=f.collection("answerCandidates"),b=f.collection("offerCandidates"),L.onicecandidate=function(e){e.candidate&&p.add(e.candidate.toJSON())},e.next=34,f.get();case 34:return m=e.sent.data(),x=m.offer,e.next=38,L.setRemoteDescription(new RTCSessionDescription(x));case 38:return e.next=40,L.createAnswer();case 40:return g=e.sent,e.next=43,L.setLocalDescription(g);case 43:return y={type:g.type,sdp:g.sdp},e.next=46,f.update({answer:y});case 46:b.onSnapshot((function(e){e.docChanges().forEach((function(e){if("added"===e.type){var t=e.doc.data();L.addIceCandidate(new RTCIceCandidate(t))}}))}));case 47:L.onconnectionstatechange=function(e){"disconnected"===L.connectionState&&O()};case 48:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(f.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L.close(),!b){e.next=9;break}return t=D.collection("calls").doc(b),e.next=5,t.collection("answerCandidates").get().then((function(e){e.forEach((function(e){e.ref.delete()}))}));case 5:return e.next=7,t.collection("offerCandidates").get().then((function(e){e.forEach((function(e){e.ref.delete()}))}));case 7:return e.next=9,t.delete();case 9:window.location.reload();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(T.jsxs)("div",{className:"videos",children:[Object(T.jsx)("video",{ref:j,autoPlay:!0,playsInline:!0,className:"local",muted:!0}),Object(T.jsx)("video",{ref:v,autoPlay:!0,playsInline:!0,className:"remote"}),Object(T.jsxs)("div",{className:"buttonsContainer",children:[Object(T.jsx)("button",{onClick:O,disabled:!i,className:"hangup button",children:Object(T.jsx)(g,{})}),Object(T.jsxs)("div",{tabIndex:0,role:"button",className:"more button",children:[Object(T.jsx)(I,{}),Object(T.jsx)("div",{className:"popover",children:Object(T.jsxs)("button",{onClick:function(){navigator.clipboard.writeText(b)},children:[Object(T.jsx)(R,{})," Copier le code de connexion"]})})]})]}),!i&&Object(T.jsx)("div",{className:"modalContainer",children:Object(T.jsxs)("div",{className:"modal",children:[Object(T.jsx)("h3",{children:"Allumez votre cam\xe9ra et votre microphone et d\xe9marrez l'appel"}),Object(T.jsxs)("div",{className:"container",children:[Object(T.jsx)("button",{onClick:function(){return r("home")},className:"secondary",children:"Annuler"}),Object(T.jsx)("button",{onClick:m,children:"Commencer"})]})]})})]})}var z=function(){var e=Object(o.useState)("home"),t=Object(p.a)(e,2),n=t[0],r=t[1],a=Object(o.useState)(""),c=Object(p.a)(a,2),i=c[0],s=c[1];return Object(T.jsx)("div",{className:"app",children:"home"===n?Object(T.jsx)(J,{joinCode:i,setJoinCode:s,setPage:r}):Object(T.jsx)(A,{mode:n,callId:i,setPage:r})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,28)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};l.a.render(Object(T.jsx)(i.a.StrictMode,{children:Object(T.jsx)(z,{})}),document.getElementById("root")),B()}},[[26,1,2]]]);
//# sourceMappingURL=main.aa13159d.chunk.js.map